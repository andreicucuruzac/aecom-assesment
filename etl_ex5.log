2025-12-15 18:42:03,744 - INFO - === [ex_5] ETL pipeline with validation started ===
2025-12-15 18:42:03,744 - INFO - Reading CSV files from C:\Users\andre\OneDrive\Desktop\AECOM\data
2025-12-15 18:42:03,750 - INFO - === [ex_5] Cleaning products ===
2025-12-15 18:42:03,750 - INFO - Raw products rows: 150
2025-12-15 18:42:03,753 - WARNING - [products] 7 rows with negative price; price set to NULL
2025-12-15 18:42:03,754 - INFO - Clean products rows: 150
2025-12-15 18:42:03,754 - INFO - === [ex_5] Cleaning customers ===
2025-12-15 18:42:03,754 - INFO - Raw customers rows (including duplicates): 627
2025-12-15 18:42:03,756 - WARNING - [customers] 32 rows with invalid email format; email set to NULL
2025-12-15 18:42:03,759 - WARNING - [customers] Duplicate customer_id C0004 with 2 records; resolving...
2025-12-15 18:42:03,771 - WARNING - [customers] Duplicate customer_id C0005 with 2 records; resolving...
2025-12-15 18:42:03,783 - WARNING - [customers] Duplicate customer_id C0031 with 2 records; resolving...
2025-12-15 18:42:03,799 - WARNING - [customers] Duplicate customer_id C0062 with 2 records; resolving...
2025-12-15 18:42:03,801 - WARNING - [customers] Duplicate customer_id C0066 with 2 records; resolving...
2025-12-15 18:42:03,846 - WARNING - [customers] Duplicate customer_id C0154 with 2 records; resolving...
2025-12-15 18:42:03,857 - WARNING - [customers] Duplicate customer_id C0176 with 2 records; resolving...
2025-12-15 18:42:03,859 - WARNING - [customers] Duplicate customer_id C0178 with 2 records; resolving...
2025-12-15 18:42:03,867 - WARNING - [customers] Duplicate customer_id C0194 with 2 records; resolving...
2025-12-15 18:42:03,891 - WARNING - [customers] Duplicate customer_id C0241 with 2 records; resolving...
2025-12-15 18:42:03,905 - WARNING - [customers] Duplicate customer_id C0270 with 2 records; resolving...
2025-12-15 18:42:03,915 - WARNING - [customers] Duplicate customer_id C0286 with 2 records; resolving...
2025-12-15 18:42:03,921 - WARNING - [customers] Duplicate customer_id C0297 with 2 records; resolving...
2025-12-15 18:42:03,923 - WARNING - [customers] Duplicate customer_id C0300 with 2 records; resolving...
2025-12-15 18:42:03,940 - WARNING - [customers] Duplicate customer_id C0332 with 2 records; resolving...
2025-12-15 18:42:03,944 - WARNING - [customers] Duplicate customer_id C0338 with 2 records; resolving...
2025-12-15 18:42:03,957 - WARNING - [customers] Duplicate customer_id C0365 with 2 records; resolving...
2025-12-15 18:42:03,965 - WARNING - [customers] Duplicate customer_id C0379 with 2 records; resolving...
2025-12-15 18:42:03,977 - WARNING - [customers] Duplicate customer_id C0402 with 2 records; resolving...
2025-12-15 18:42:03,993 - WARNING - [customers] Duplicate customer_id C0435 with 2 records; resolving...
2025-12-15 18:42:03,998 - WARNING - [customers] Duplicate customer_id C0445 with 2 records; resolving...
2025-12-15 18:42:04,009 - WARNING - [customers] Duplicate customer_id C0465 with 2 records; resolving...
2025-12-15 18:42:04,013 - WARNING - [customers] Duplicate customer_id C0474 with 2 records; resolving...
2025-12-15 18:42:04,032 - WARNING - [customers] Duplicate customer_id C0512 with 2 records; resolving...
2025-12-15 18:42:04,039 - WARNING - [customers] Duplicate customer_id C0524 with 2 records; resolving...
2025-12-15 18:42:04,052 - WARNING - [customers] Duplicate customer_id C0548 with 2 records; resolving...
2025-12-15 18:42:04,062 - WARNING - [customers] Duplicate customer_id C0568 with 2 records; resolving...
2025-12-15 18:42:04,084 - INFO - Clean customers rows after de-duplication: 600
2025-12-15 18:42:04,085 - INFO - === [ex_5] Cleaning sales ===
2025-12-15 18:42:04,085 - INFO - Raw sales rows: 1570
2025-12-15 18:42:04,088 - ERROR - [sales] 109 rows with non-positive quantity (<=0); dropping these rows
2025-12-15 18:42:04,090 - ERROR - [sales] 108 rows with invalid transaction_date format; dropping these rows
2025-12-15 18:42:04,091 - INFO - Clean sales rows after basic validation: 1353
2025-12-15 18:42:04,092 - INFO - === [ex_5] Checking referential integrity for sales ===
2025-12-15 18:42:04,104 - ERROR - [sales] Referential integrity violations: 73 rows with non-existent product_id/customer_id
2025-12-15 18:42:04,104 - INFO - Sales rows valid after referential check: 1280
2025-12-15 18:42:04,104 - INFO - === [ex_5] Loading cleaned data into MariaDB ===
2025-12-15 18:42:04,104 - INFO - DB: AECOMDB @ 192.168.0.12:3306
2025-12-15 18:42:04,378 - INFO - [load] ex_5_products: 150 rows, ex_5_customers: 600 rows, ex_5_sales (valid): 1280 rows
2025-12-15 18:42:04,418 - INFO - [load] ex_5_sales_rejected: 73 rows with validation / referential errors
2025-12-15 18:42:04,418 - INFO - === [ex_5] ETL pipeline finished successfully ===
