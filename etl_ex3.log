2025-12-15 17:46:01,248 - INFO - === ETL pipeline (Exercise 3 - incremental) started ===
2025-12-15 17:46:01,248 - INFO - Reading CSV files from C:\Users\andre\OneDrive\Desktop\AECOM\data
2025-12-15 17:46:01,265 - INFO - === Transforming products ===
2025-12-15 17:46:01,265 - INFO - Raw products rows: 150
2025-12-15 17:46:01,266 - WARNING - Dropping 13 products with missing product_name
2025-12-15 17:46:01,267 - WARNING - Found 7 products with non-numeric price (including N/A)
2025-12-15 17:46:01,268 - WARNING - Setting 7 negative prices to NULL
2025-12-15 17:46:01,268 - INFO - Clean products rows: 137
2025-12-15 17:46:01,269 - INFO - === Transforming customers ===
2025-12-15 17:46:01,269 - INFO - Raw customers rows (including duplicates): 627
2025-12-15 17:46:01,270 - WARNING - Setting 32 invalid emails to NULL
2025-12-15 17:46:01,273 - WARNING - Duplicate customer_id C0004 with 2 records, resolving...
2025-12-15 17:46:01,274 - WARNING - Duplicate customer_id C0005 with 2 records, resolving...
2025-12-15 17:46:01,286 - WARNING - Duplicate customer_id C0031 with 2 records, resolving...
2025-12-15 17:46:01,302 - WARNING - Duplicate customer_id C0062 with 2 records, resolving...
2025-12-15 17:46:01,304 - WARNING - Duplicate customer_id C0066 with 2 records, resolving...
2025-12-15 17:46:01,345 - WARNING - Duplicate customer_id C0154 with 2 records, resolving...
2025-12-15 17:46:01,356 - WARNING - Duplicate customer_id C0176 with 2 records, resolving...
2025-12-15 17:46:01,357 - WARNING - Duplicate customer_id C0178 with 2 records, resolving...
2025-12-15 17:46:01,365 - WARNING - Duplicate customer_id C0194 with 2 records, resolving...
2025-12-15 17:46:01,387 - WARNING - Duplicate customer_id C0241 with 2 records, resolving...
2025-12-15 17:46:01,401 - WARNING - Duplicate customer_id C0270 with 2 records, resolving...
2025-12-15 17:46:01,409 - WARNING - Duplicate customer_id C0286 with 2 records, resolving...
2025-12-15 17:46:01,415 - WARNING - Duplicate customer_id C0297 with 2 records, resolving...
2025-12-15 17:46:01,417 - WARNING - Duplicate customer_id C0300 with 2 records, resolving...
2025-12-15 17:46:01,436 - WARNING - Duplicate customer_id C0332 with 2 records, resolving...
2025-12-15 17:46:01,440 - WARNING - Duplicate customer_id C0338 with 2 records, resolving...
2025-12-15 17:46:01,454 - WARNING - Duplicate customer_id C0365 with 2 records, resolving...
2025-12-15 17:46:01,462 - WARNING - Duplicate customer_id C0379 with 2 records, resolving...
2025-12-15 17:46:01,473 - WARNING - Duplicate customer_id C0402 with 2 records, resolving...
2025-12-15 17:46:01,489 - WARNING - Duplicate customer_id C0435 with 2 records, resolving...
2025-12-15 17:46:01,495 - WARNING - Duplicate customer_id C0445 with 2 records, resolving...
2025-12-15 17:46:01,505 - WARNING - Duplicate customer_id C0465 with 2 records, resolving...
2025-12-15 17:46:01,509 - WARNING - Duplicate customer_id C0474 with 2 records, resolving...
2025-12-15 17:46:01,528 - WARNING - Duplicate customer_id C0512 with 2 records, resolving...
2025-12-15 17:46:01,534 - WARNING - Duplicate customer_id C0524 with 2 records, resolving...
2025-12-15 17:46:01,546 - WARNING - Duplicate customer_id C0548 with 2 records, resolving...
2025-12-15 17:46:01,556 - WARNING - Duplicate customer_id C0568 with 2 records, resolving...
2025-12-15 17:46:01,577 - INFO - Customers after de-duplication: 600
2025-12-15 17:46:01,577 - INFO - === Transforming sales ===
2025-12-15 17:46:01,578 - INFO - Raw sales rows: 1570
2025-12-15 17:46:01,578 - WARNING - Dropping 86 sales rows with missing product_id or customer_id
2025-12-15 17:46:01,579 - WARNING - Dropping 102 sales rows with invalid quantity (<=0 or non-numeric)
2025-12-15 17:46:01,581 - WARNING - Dropping 102 sales rows with unparseable transaction_date
2025-12-15 17:46:01,582 - INFO - Clean sales rows: 1280
2025-12-15 17:46:01,583 - INFO - === Loading ex_3_* tables into MariaDB ===
2025-12-15 17:46:01,583 - INFO - Using DB: AECOMDB @ 192.168.0.12:3306
2025-12-15 17:46:01,771 - INFO - Loaded 137 products into ex_3_products
2025-12-15 17:46:01,772 - INFO - Loaded 600 customers into ex_3_customers
2025-12-15 17:46:01,772 - INFO - === Incremental load for ex_3_sales ===
2025-12-15 17:46:01,775 - INFO - Last watermark from state table: 2026-01-19
2025-12-15 17:46:01,779 - INFO - Sales load mode: incremental. Rows to load: 20
2025-12-15 17:46:01,928 - INFO - Updated watermark to 2026-02-08
2025-12-15 17:46:01,928 - INFO - === ETL pipeline finished successfully ===
